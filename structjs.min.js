(function(e){if("function"==typeof bootstrap)bootstrap("struct",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeStruct=e}else"undefined"!=typeof window?window.Struct=e():global.Struct=e()})(function(){var e,t,n,r,i;return function s(e,t,n){function r(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return r(n?n:t)},f,f.exports,s,e,t,n)}return t[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){var r=e("./types/number"),i=e("./types/string"),s=e("./types/hash"),o=e("./types/array"),u=e("./types/reference"),a=e("./types/storage"),f=t.exports=function(e){var t=function(){Object.defineProperties(this,{_view:{writable:!0,value:null},_offset:{writable:!0,value:null}})},n=[];return t.extendIf=function(e,t){return n.push({condition:e,extension:t}),this},t.prototype.unpack=function(t,r){function s(e){for(var n in e){var s=e[n];s.parent=i,s instanceof a&&(i[n]=s)}for(var n in e){var s=e[n];if(s instanceof a)continue;s.storage&&s.storage.contents.push({type:s,struct:i,prop:n}),i[n]=s.read(t,r),s.external||(r+=s.$length*s.$size)}}if(t instanceof DataView){this._view=t,this._offset=r,r||(r=0);var i=this;return s(e),n.forEach(function(e){if(!e.condition.call(i))return;s(e.extension)}),typeof this.$initialize=="function"&&this.$initialize(),this}throw new Error("DataView expected")},t.prototype.pack=function(t,i){function o(e){var n=i;for(var o in e){var u=e[o];if(u.external||u.storage)continue;u instanceof a&&(u.$offset=i,!function(){var e=0;u.contents.forEach(function(n){var r=n.type;r.parent=n.struct,r.$offset=e,r.write(t,e,n.struct[n.prop]),e+=r.$length*r.$size})}()),i+=u.$length*u.$size}i=n;for(var o in e){var u=e[o];if(u.external||u.storage||u instanceof a)continue;u instanceof r||u.write(t,i,s[o]),i+=u.$length*u.$size}i=n;for(var o in e){var u=e[o];if(u.external||u.storage)continue;u instanceof r&&u.write(t,i,s[o]),i+=u.$length*u.$size}}t||(t=new DataView(new ArrayBuffer(this.$length*this.$size))),i||(i=0);var s=this;return o(e),n.forEach(function(e){if(!e.condition.call(s))return;o(e.extension)}),t.buffer.slice(0,i)},Object.defineProperty(t.prototype,"$length",{enumerable:!0,value:1}),Object.defineProperty(t.prototype,"$size",{enumerable:!0,get:function(){return Object.keys(e).filter(function(t){return!e[t].external&&!e[t].storage}).map(function(t){return e[t].$length*e[t].$size}).reduce(function(e,t){return e+t},0)}}),t};f.Int8=new r("getInt8","setInt8",1),f.Uint8=new r("getUint8","setUint8",1),f.Int16=new r("getInt16","setInt16",2),f.Uint16=new r("getUint16","setUint16",2),f.Int32=new r("getInt32","setInt32",4),f.Uint32=new r("getUint32","setUint32",4),f.Float32=new r("getFloat32","setFloat32",4),f.Float64=new r("getFloat64","setFloat64",8),f.String=function(e){return new i(e)},f.Hash=function(e,t,n){return new s(e,t,n)},f.Array=function(e,t){return new o(e,t)},f.Reference=f.Ref=function(e){return new u(e)},f.Storage=function(e){return new a(e)}},{"./types/array":2,"./types/hash":3,"./types/number":4,"./types/reference":5,"./types/storage":6,"./types/string":7}],2:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e,t){this.struct=e,Object.defineProperties(this,{_length:{value:t,writable:!0}}),this.$size=(e.$size||e.prototype.$size)*(e.$length||e.prototype.$length)};i.prototype.read=function(e,t){var n=[];for(var r=0,i=this.$length;r<i;++r){var s;typeof this.struct=="function"?(s=new this.struct,s.parent=this.parent,s.unpack(e,t),t+=s.$length*s.$size):(s=this.struct.read(e,t),t+=this.struct.$length*this.struct.$size),n.push(s)}return n},i.prototype.write=function(e,t,n){this.$length=n.length;for(var r=0,i=this.$length;r<i;++r){var s=n[r];typeof this.struct=="function"?(s.pack(e,t),t+=s.$length*s.$size):(this.struct.write(e,t,s),t+=this.struct.$length*this.struct.$size)}},r.getter(i.prototype,"_length","$length")},{"../utils":8}],3:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e,t,n){this.struct=e,this.prop=t,Object.defineProperties(this,{_length:{value:n,writable:!0}}),this.$size=(e.$size||e.prototype.$size)*(e.$length||e.prototype.$length)};i.prototype.read=function(e,t){var n={};for(var r=0,i=this.$length;r<i;++r){var s=new this.struct;s.parent=this.parent,s.unpack(e,t),t+=s.$length*s.$size,n[s[this.prop]]=s}return n},i.prototype.write=function(e,t,n){var r=Object.keys(n);this.$length=r.length;for(var i=0,s=this.$length;i<s;++i){var o=n[r[i]];o.pack(e,t),t+=o.$length*o.$size}},r.getter(i.prototype,"_length","$length")},{"../utils":8}],4:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e,t,n){this.methods={read:e,write:t},Object.defineProperties(this,{_offset:{value:null,writable:!0},_length:{value:null,writable:!0}}),r.options.call(this,n)};i.prototype.from=function(e){return new i(this.methods.read,this.methods.write,{length:this.length,offset:e,external:!0})},i.prototype.read=function(e,t){return e[this.methods.read](this.external?this.$offset:t)},i.prototype.write=function(e,t,n){e[this.methods.write](this.external?this.$offset:t,n)},r.getter(i.prototype,"_offset","$offset"),Object.defineProperties(i.prototype,{$length:{enumerable:!0,value:1},$size:{enumerable:!0,get:function(){return this._length}}})},{"../utils":8}],5:[function(e,t,n){var r=t.exports=function(e){this.prop=e};r.prototype.get=function(e){if(!e)return 0;var t=e[this.prop];return t===undefined&&e.parent?e.parent[this.prop]:t},r.prototype.set=function(e,t){e[this.prop]=t}},{}],6:[function(e,t,n){var r=e("../utils"),i=e("./reference"),s=t.exports=function(e){e instanceof i&&(e={offset:e}),this.opts=e||{},this.contents=[],this.$length=1,Object.defineProperties(this,{_offset:{value:this.opts.offset,writable:!0}})};r.getter(s.prototype,"_offset","$offset"),Object.defineProperty(s.prototype,"$size",{enumerable:!0,get:function(){return this.contents.map(function(e){var t=e.type;return t.parent=e.struct,t.$length*t.$size}).reduce(function(e,t){return e+t},0)}})},{"../utils":8,"./reference":5}],7:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e){Object.defineProperties(this,{_offset:{value:null,writable:!0},_length:{value:null,writable:!0},_size:{value:null,writable:!0}}),r.options.call(this,e),this.$size=this._size||1};i.prototype.read=function(e,t){var n=[],r=this.external?this.$offset:this.storage?this.storage.$offset+this.$offset:t;for(var i=0,s=this.$length,o=this.$size===2?2:1;i<s;i+=o)n.push(e[this.$size===2?"getUint16":"getUint8"](r+i,this.littleEndian));return String.fromCharCode.apply(null,n)},i.prototype.write=function(e,t,n){var r=[],i=this.external?this.$offset:this.storage?this.storage.$offset+this.$offset:t;for(var s=0,o=this.$length,u=this.$size===2?2:1;s<o;s+=u){var a=n.charCodeAt(s)||0;e[this.$size===2?"setUint16":"setUint8"](i+s,a,this.littleEndian)}},r.getter(i.prototype,"_length","$length"),r.getter(i.prototype,"_offset","$offset"),r.getter(i.prototype,"_storage","storage")},{"../utils":8}],8:[function(e,t,n){var r=e("./types/reference");n.getter=function(e,t,n){Object.defineProperty(e,n,{enumerable:!0,get:function(){return this[t]?this[t]instanceof r?this[t].get(this.parent):this[t]:0},set:function(e){this[t]instanceof r?this[t].set(this.parent,e):this[t]=e}})},n.options=function(e){typeof e=="object"?(this._offset=e.offset,this._length=e.length,this._size=e.size,this.external=e.external===!0,this._storage=e.storage,this.littleEndian=e.littleEndian===!0):this._length=e}},{"./types/reference":5}]},{},[1])(1)});