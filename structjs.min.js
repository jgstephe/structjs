(function(e){if("function"==typeof bootstrap)bootstrap("struct",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeStruct=e}else"undefined"!=typeof window?window.Struct=e():global.Struct=e()})(function(){var e,t,n,r,i;return function s(e,t,n){function r(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return r(n?n:t)},f,f.exports,s,e,t,n)}return t[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){var r=e("./types/number"),i=e("./types/string"),s=e("./types/hash"),o=e("./types/array"),u=e("./types/reference"),a=e("./types/storage"),f=t.exports=function(e){var t=function(){Object.defineProperties(this,{_view:{writable:!0,value:null},_offset:{writable:!0,value:null},_definition:{writable:!1,value:e}})};Object.defineProperty(t,"_definition",{writable:!1,value:e});var n=[];return t.extendIf=function(e,t){return n.push({condition:e,extension:t}),this},t.prototype.unpack=function(t,r){function s(e){for(var n in e){var s=e[n];if(s.storage)continue;i[n]=s.read(t,r),i[n]===undefined&&delete i[n],s.external||(r+=s.lengthFor(i)*s.sizeFor(i))}}if(t instanceof DataView){this._view=t,this._offset=r,r||(r=0);var i=this;return s.parent=this,s(e),n.forEach(function(e){if(!e.condition.call(i))return;s(e.extension)}),typeof this.$initialize=="function"&&this.$initialize(),this}throw new Error("DataView expected")},t.prototype.pack=function(t,i){function o(e){var n=i;i=n;for(var o in e){var u=e[o];if(u.external||u.storage)continue;u instanceof r||u.write(t,i,s[o]),i+=u.lengthFor(s)*u.sizeFor(s)}i=n;for(var o in e){var u=e[o];if(u.external||u.storage)continue;u instanceof r&&u.write(t,i,s[o]),i+=u.lengthFor(s)*u.sizeFor(s)}}t||(t=new DataView(new ArrayBuffer(this.lengthFor(this)*this.sizeFor(this)))),i||(i=0);var s=this;return o.parent=this,o(e),n.forEach(function(e){if(!e.condition.call(s))return;o(e.extension)}),t.buffer.slice(0,i)},t.prototype.lengthFor=function(){return 1},t.prototype.sizeFor=function(){var t=this;return Object.keys(e).filter(function(t){return!e[t].external&&!e[t].storage}).map(function(n){return e[n].lengthFor(t)*e[n].sizeFor(t)}).reduce(function(e,t){return e+t},0)},t};f.Int8=new r("getInt8","setInt8",1),f.Uint8=new r("getUint8","setUint8",1),f.Int16=new r("getInt16","setInt16",2),f.Uint16=new r("getUint16","setUint16",2),f.Int32=new r("getInt32","setInt32",4),f.Uint32=new r("getUint32","setUint32",4),f.Float32=new r("getFloat32","setFloat32",4),f.Float64=new r("getFloat64","setFloat64",8),f.String=function(e){return new i(e)},f.Hash=function(e,t,n){return new s(e,t,n)},f.Array=function(e,t){return new o(e,t)},f.Reference=f.Ref=function(e){return new u(e)},f.Storage=function(e,t){return new a(e,t)}},{"./types/array":2,"./types/hash":3,"./types/number":4,"./types/reference":5,"./types/storage":6,"./types/string":7}],2:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e,t){this.struct=e,Object.defineProperties(this,{_length:{value:t,writable:!0}})};i.prototype.read=function s(e,t){var n=[],r=s.caller.parent;for(var i=0,o=this.lengthFor(r);i<o;++i){var u;typeof this.struct=="function"?(u=new this.struct,u.unpack(e,t),t+=u.lengthFor(r)*u.sizeFor(r)):(u=this.struct.read(e,t),t+=this.struct.lengthFor(r)*this.struct.sizeFor(r)),n.push(u)}return n},i.prototype.write=function o(e,t,n){var r=o.caller.parent;this.setLength(n.length,r);for(var i=0,s=this.lengthFor(r);i<s;++i){var u=n[i];typeof this.struct=="function"?(u.pack(e,t),t+=u.lengthFor(r)*u.sizeFor(r)):(this.struct.write(e,t,u),t+=this.struct.lengthFor(r)*this.struct.sizeFor(r))}},i.prototype.sizeFor=function(e){return(this.struct.sizeFor?this.struct.sizeFor(e):this.struct.prototype.sizeFor(e))*(this.struct.lengthFor?this.struct.lengthFor(e):this.struct.prototype.lengthFor(e))},r.methodsFor(i.prototype,"_length","lengthFor","setLength")},{"../utils":8}],3:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e,t,n){this.struct=e,this.prop=t,Object.defineProperties(this,{_length:{value:n,writable:!0}})};i.prototype.read=function s(e,t){var n={},r=s.caller.parent;for(var i=0,o=this.lengthFor(r);i<o;++i){var u=new this.struct;u.unpack(e,t),t+=u.lengthFor(r)*u.sizeFor(r),n[u[this.prop]]=u}return n},i.prototype.write=function o(e,t,n){var r=Object.keys(n),i=o.caller.parent;this.setLength(r.length,i);for(var s=0,u=this.lengthFor(i);s<u;++s){var a=n[r[s]];a.pack(e,t),t+=a.lengthFor(i)*a.sizeFor(i)}},i.prototype.sizeFor=function(e){return(this.struct.sizeFor?this.struct.sizeFor(e):this.struct.prototype.sizeFor(e))*(this.struct.lengthFor?this.struct.lengthFor(e):this.struct.prototype.lengthFor(e))},r.methodsFor(i.prototype,"_length","lengthFor","setLength")},{"../utils":8}],4:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e,t,n){this.methods={read:e,write:t},Object.defineProperties(this,{_offset:{value:null,writable:!0},_length:{value:null,writable:!0}}),r.options.call(this,n)};i.prototype.from=function(e){return new i(this.methods.read,this.methods.write,{length:this.length,offset:e,external:!0})},i.prototype.read=function s(e,t){var n=s.caller.parent;return e[this.methods.read](this.external?this.offsetFor(n):t)},i.prototype.write=function o(e,t,n){var r=o.caller.parent;e[this.methods.write](this.external?this.offsetFor(r):t,n)},i.prototype.lengthFor=function(){return 1},i.prototype.sizeFor=function(){return this._length},r.methodsFor(i.prototype,"_offset","offsetFor","setOffset")},{"../utils":8}],5:[function(e,t,n){var r=t.exports=function(e){this.prop=e}},{}],6:[function(e,t,n){function u(e){}var r=e("../utils"),i=e("./reference"),s=e("./array"),o=t.exports=function(e,t){this.path=e,t instanceof i&&(t={offset:t}),t=t||{},Object.defineProperties(this,{_offset:{value:t.offset,writable:!0}})};o.prototype.read=function a(e,t){var n=a.caller.parent,r=this.offsetFor(n)||t;!function i(t,n,o){var u=t.shift(),a=n[u];i.parent=o,t.length?a instanceof s?o[u].forEach(function(e){i(t.concat([]),a.struct._definition,e)}):i(t,a,o[u]):o[u]=a.read(e,r)}(this.path.split("."),n._definition,n)},o.prototype.write=function f(e,t){var n=f.caller.parent;this.setOffset(t,n),!function r(n,i,o){var u=n.shift(),a=i[u];r.parent=o,n.length?a instanceof s?o[u].forEach(function(e){r(n.concat([]),a.struct._definition,e)}):r(n,a,o[u]):a.write(e,t,o[u])}(this.path.split("."),n._definition,n)},o.prototype.lengthFor=function(){return 1},o.prototype.sizeFor=function(e){var t=0;return!function n(e,r,i){var o=e.shift(),u=r[o];n.parent=i,e.length?u instanceof s?i[o].forEach(function(t){n(e.concat([]),u.struct._definition,t)}):n(e,u,i[o]):t+=u.lengthFor(i)*u.sizeFor(i)}(this.path.split("."),e._definition,e),t},r.methodsFor(o.prototype,"_offset","offsetFor","setOffset")},{"../utils":8,"./array":2,"./reference":5}],7:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e){Object.defineProperties(this,{_offset:{value:null,writable:!0},_length:{value:null,writable:!0},_size:{value:null,writable:!0}}),r.options.call(this,e)};i.prototype.read=function s(e,t){var n=[],r,i=s.caller.parent,o=this.external?this.offsetFor(i):this.storage?t+this.offsetFor(i):t;for(var u=0,a=this.lengthFor(i),f=this.sizeFor()===2?2:1;u<a;u+=f)n.push(e[this.sizeFor()===2?"getUint16":"getUint8"](o+u,this.littleEndian));return String.fromCharCode.apply(null,n)},i.prototype.write=function o(e,t,n){var r=[],i,s=o.caller.parent,u=this.external?this.offsetFor(s):this.storage?t+this.offsetFor(s):t;for(var a=0,f=this.lengthFor(s),l=this.sizeFor()===2?2:1;a<f;a+=l){var c=n.charCodeAt(a)||0;e[this.sizeFor()===2?"setUint16":"setUint8"](u+a,c,this.littleEndian)}},i.prototype.sizeFor=function(){return this._size||1},r.methodsFor(i.prototype,"_length","lengthFor","setLength"),r.methodsFor(i.prototype,"_offset","offsetFor","setOffset")},{"../utils":8}],8:[function(e,t,n){var r=e("./types/reference");n.methodsFor=function(e,t,n,i){e[n]=function(e){return this[t]?this[t]instanceof r?e[this[t].prop]:this[t]:0};if(!i)return;e[i]=function(e,n){this[t]instanceof r?n[this[t].prop]=e:this[t]=e}},n.options=function(e){typeof e=="object"?(this._offset=e.offset,this._length=e.length,this._size=e.size,this.external=e.external===!0,this.storage=e.storage,this.littleEndian=e.littleEndian===!0):this._length=e}},{"./types/reference":5}]},{},[1])(1)});